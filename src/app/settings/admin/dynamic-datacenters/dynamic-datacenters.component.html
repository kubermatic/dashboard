<mat-card class="km-with-table-header">
  <mat-card-header>
    <mat-card-title>Dynamic Datacenters</mat-card-title>
    <div fxFlex></div>
    <div class="filters"
         fxLayoutAlign=" center"
         fxLayoutGap="16px">
      <div class="filter-title">Filter by</div>
      <mat-form-field fxFlex>
        <mat-label>Seed</mat-label>
        <mat-select disableOptionCentering
                    [(ngModel)]="seedFilter"
                    (selectionChange)="filterDatacenters()">
          <mat-select-trigger fxFlex
                              fxLayout="row">
            <div fxFlex
                 fxLayoutAlign="start">{{seedFilter}}</div>
            <div fxFlex
                 fxLayoutAlign="end">
              <button *ngIf="seedFilter"
                      (click)="seedFilter = undefined; filterDatacenters(); $event.stopPropagation()"
                      mat-icon-button
                      aria-label="Clear"
                      class="clear-filter">
                <mat-icon class="km-icon"
                          inline="true">close</mat-icon>
              </button>
            </div>
          </mat-select-trigger>
          <mat-option *ngFor="let seed of seeds"
                      [value]="seed">
            {{seed}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field fxFlex>
        <mat-label>Country</mat-label>
        <mat-select disableOptionCentering
                    [(ngModel)]="countryFilter"
                    (selectionChange)="filterDatacenters()">
          <mat-select-trigger fxFlex
                              fxLayout="row">
            <div fxFlex
                 fxLayoutAlign="start">{{getCountryName(countryFilter)}}</div>
            <div fxFlex
                 fxLayoutAlign="end">
              <button *ngIf="countryFilter"
                      (click)="countryFilter = undefined; filterDatacenters(); $event.stopPropagation()"
                      mat-icon-button
                      aria-label="Clear"
                      class="clear-filter">
                <mat-icon class="km-icon"
                          inline="true">close</mat-icon>
              </button>
            </div>
          </mat-select-trigger>
          <mat-option *ngFor="let country of countries"
                      [value]="country">
            {{getCountryName(country)}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field fxFlex>
        <mat-label>Provider</mat-label>
        <mat-select disableOptionCentering
                    [(ngModel)]="providerFilter"
                    (selectionChange)="filterDatacenters()">
          <mat-select-trigger fxFlex
                              fxLayout="row">
            <div fxFlex
                 fxLayoutAlign="start">{{getProviderName(providerFilter)}}</div>
            <div fxFlex
                 fxLayoutAlign="end">
              <button *ngIf="providerFilter"
                      (click)="providerFilter = undefined; filterDatacenters(); $event.stopPropagation()"
                      mat-icon-button
                      aria-label="Clear"
                      class="clear-filter">
                <mat-icon class="km-icon"
                          inline="true">close</mat-icon>
              </button>
            </div>
          </mat-select-trigger>
          <mat-option *ngFor="let provider of providers"
                      [value]="provider">
            {{getProviderName(provider)}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </mat-card-header>
  <mat-card-content>
    <table class="km-table"
           mat-table
           matSort
           #datacentersSort="matSort"
           [dataSource]="dataSource">
      <ng-container matColumnDef="datacenter">
        <th mat-header-cell
            *matHeaderCellDef
            class="km-header-cell"
            mat-sort-header>Datacenter</th>
        <td mat-cell
            *matCellDef="let element">{{element.metadata.name}}</td>
      </ng-container>

      <ng-container matColumnDef="seed">
        <th mat-header-cell
            *matHeaderCellDef
            class="km-header-cell"
            mat-sort-header>Seed Cluster</th>
        <td mat-cell
            *matCellDef="let element">{{element.spec.seed}}</td>
      </ng-container>

      <ng-container matColumnDef="country">
        <th mat-header-cell
            *matHeaderCellDef
            class="km-header-cell"
            mat-sort-header>Country</th>
        <td mat-cell
            *matCellDef="let element"
            fxLayoutGap="6px">
          <ng-container *ngIf="element.spec && element.spec.country">
            <span class="flag-icon flag-icon-{{element.spec.country.toLowerCase()}}"></span>
            <span>{{getCountryName(element.spec.country)}}</span>
          </ng-container>
        </td>
      </ng-container>

      <ng-container matColumnDef="provider">
        <th mat-header-cell
            *matHeaderCellDef
            class="km-header-cell"
            mat-sort-header>Provider</th>
        <td mat-cell
            *matCellDef="let element"
            fxLayoutAlign=" center"><span class="km-provider-logo km-provider-logo-{{element.spec.provider}}"></span></td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell
            *matHeaderCellDef
            class="km-header-cell"></th>
        <td mat-cell
            *matCellDef="let element">
          <div class="km-table-actions">
            <button mat-icon-button
                    (click)="deleteDatacenter(element)">
              <i class="km-icon-delete"></i>
            </button>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row
          class="km-header-row"
          *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row
          *matRowDef="let row; columns: displayedColumns"
          class="km-mat-row"></tr>
    </table>

    <ng-container *ngIf="!datacenters">
      <div class="km-row">
        <mat-spinner color="accent"
                     class="km-spinner"
                     [diameter]="25"></mat-spinner>
      </div>
    </ng-container>

    <div [hidden]="!isDatacentersPaginatorVisible()">
      <mat-paginator showFirstLastButtons
                     #datacentersPaginator
                     class="km-paginator"></mat-paginator>
    </div>

  </mat-card-content>
</mat-card>
