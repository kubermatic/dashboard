<ng-container *ngIf="isInitialized()">
  <km-cluster-panel [cluster]="cluster"
                    [datacenter]="datacenter"
                    [projectID]="projectID"
                    [dcName]="dcName"></km-cluster-panel>

  <mat-card class="white km-cluster-details">
    <mat-card-header>
      <mat-card-title>
        <i [matTooltip]="nodeDeploymentHealthStatus.message"
           [ngClass]="nodeDeploymentHealthStatus.color"
           class="km-node-deployment-health"></i>
        <span class="km-node-deployment-name">{{nodeDeployment.name}}</span>
      </mat-card-title>

      <div class="km-node-deployment-actions"
           fxLayout="row">
        <div [ngClass]="getButtonWrapperClass(!isEditEnabled())">
          <button mat-icon-button
                  (click)="showEditDialog()"
                  [disabled]="!isEditEnabled()">
            <mat-icon>edit</mat-icon>
          </button>
        </div>
        <div [ngClass]="getButtonWrapperClass(!isDeleteEnabled())">
          <button mat-icon-button
                  color="primary"
                  (click)="showDeleteDialog()"
                  [disabled]="!isDeleteEnabled()">
            <i class="km-icon-delete"></i>
          </button>
        </div>
      </div>

    </mat-card-header>
    <mat-card-content class="km-row">

      <div class="km-content-wrap">
        <km-property>
          <div key>{{getVersionHeadline(cluster.type, true)}}</div>
          <div value>{{nodeDeployment.spec.template.versions.kubelet}}</div>
        </km-property>
        <km-property>
          <div key>Replicas</div>
          <div value>
            <span>{{!!nodeDeployment.status?.availableReplicas ? nodeDeployment.status.availableReplicas : 0}}/{{!!nodeDeployment.spec?.replicas ? nodeDeployment.spec.replicas : 0}}</span>
            <span *ngIf="nodeDeployment.status?.availableReplicas > nodeDeployment.spec.replicas"
                  matTooltip="Number of available machines may be higher than number of desired machines from the template if deployment is updating.">
              <i class="fa fa-question-circle"
                 aria-hidden="true"></i>
            </span>
          </div>
        </km-property>
        <km-property>
          <div key>Paused</div>
          <div value>{{nodeDeployment.spec.paused}}</div>
        </km-property>
        <km-property>
          <div key>Operating System</div>
          <div value>{{system}}</div>
        </km-property>
        <km-property>
          <div key>Cluster Provider</div>
          <div value>
            <span class="km-provider-logo km-provider-logo-{{clusterProvider}}"></span>
          </div>
        </km-property>
        <km-property>
          <div key>Created</div>
          <div value>
            <km-relative-time [date]="nodeDeployment.creationTimestamp"></km-relative-time>
          </div>
        </km-property>
        <km-property>
          <div key>Node Labels</div>
          <div value>
            <km-labels [labels]="nodeDeployment.spec.template.labels"></km-labels>
          </div>
        </km-property>
        <km-property>
          <div key>Node Taints</div>
          <div value>
            <km-taints [taints]="nodeDeployment.spec.template.taints"></km-taints>
          </div>
        </km-property>
      </div>

      <div>
        <mat-divider></mat-divider>
        <div class="km-card-expansion-panel"
             fxFlex
             fxLayout="row wrap"
             fxLayoutAlign=" center">
          <div *ngIf="nodeDeployment.spec.template.operatingSystem.ubuntu">
            <span [ngClass]="nodeDeployment.spec.template.operatingSystem.ubuntu.distUpgradeOnBoot ? 'km-icon-running' : 'km-icon-disabled'"></span>
            <span>Upgrade system on the first boot</span>
          </div>
          <div *ngIf="nodeDeployment.spec.template.operatingSystem.centos">
            <span [ngClass]="nodeDeployment.spec.template.operatingSystem.centos.distUpgradeOnBoot ? 'km-icon-running' : 'km-icon-disabled'"></span>
            <span>Upgrade system on the first boot</span>
          </div>
          <div *ngIf="nodeDeployment.spec.template.operatingSystem.containerLinux">
            <span [ngClass]="nodeDeployment.spec.template.operatingSystem.containerLinux.disableAutoUpdate ? 'km-icon-running' : 'km-icon-disabled'"></span>
            <span>Disable auto-update</span>
          </div>
        </div>
      </div>


    </mat-card-content>
  </mat-card>

  <kubermatic-node-list [cluster]="cluster"
                        [nodes]="nodes"
                        (deleteNode)="loadNodes()"
                        [datacenter]="seedDatacenter"
                        [projectID]="getProjectID()"
                        [isClusterRunning]="true"
                        [clusterHealthStatus]="{css: 'km-status-running'}"></kubermatic-node-list>

  <km-event-list [events]="events"></km-event-list>

</ng-container>

<ng-container *ngIf="!isInitialized()">
  <mat-spinner color="accent"
               class="km-spinner"></mat-spinner>
</ng-container>
